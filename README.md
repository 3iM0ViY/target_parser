# target_parser

Для работы парсера необходим python 3.9

parser.py - версия для ОС Catalina с браузером Safari
parser_wind.py - версия для Windows, работает как минимум с браузерами Chrome и Opera

Предварительная настройка
Необходимо установить следующие пакеты:
pip install bs4
pip install pyautogui
pip install requests

В браузере необходимо выбрать следующий тип файла загрузки по умолчаниию (при нажатии Ctrl + S в выпадающем меню снизу): 
Веб страница полностью (*.html;*.html)

Нужно открыть файл и заменить следующие переменные:
HEADERS = {'user-agent': ''} - в браузере открыть страницу и проверив код открыть раздел сеть. Перезагрузить страницу с открытой вкладкой. Появится поле типа html document у которого в разделе headers есть поле user-agent. Его надо скапировать и заменить в коде.
LOCATION - путь разположения к папке в которой будут хранится временные файлы (лучше создать папку возле файла парсера и прописать путь к ней)
EXPORT_FILE - путь куда необходимо экспортировать файл ексель.

Применение
Для запуска перейти в папку с файлом в консоле, после чего инициализировать его - python3 parser_wind.py
В открывшемся окне есть поле ввода - тут прописывается поисковый запрос (например: banana). 
При нажатии кнопки search браузер откроет страницу для предпросмотра того, что необходимо пропарсить. 
При нажатии кнопки parse запускается сам парсер. 
!Важно: Во время работы курсор мыши должен находится поверх окна, для скролинга по странице.
